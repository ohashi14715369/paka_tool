(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{390:function(e,t,r){const{uniq:n,isDate:o,isRegExp:c}=r(393),l={},f={},h={},d={},y={},v=(e,t)=>{if("number"==typeof e&&(e=e.toString()),!("$"!==e[0]||"$$date"===e&&"number"==typeof t||"$$deleted"===e&&!0===t||"$$indexCreated"===e||"$$indexRemoved"===e))throw new Error("Field names cannot begin with the $ character");if(-1!==e.indexOf("."))throw new Error("Field names cannot contain a .")},m=e=>{if(Array.isArray(e)&&e.forEach((e=>{m(e)})),"object"==typeof e&&null!==e)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(v(t,e[t]),m(e[t]))};function w(e,t){if("boolean"==typeof e||"number"==typeof e||"string"==typeof e||null===e||o(e))return e;if(Array.isArray(e))return e.map((e=>w(e,t)));if("object"==typeof e){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(!t||"$"!==n[0]&&-1===n.indexOf("."))&&(r[n]=w(e[n],t));return r}}const _=e=>"boolean"==typeof e||"number"==typeof e||"string"==typeof e||null===e||o(e)||Array.isArray(e),k=(a,b)=>a<b?-1:a>b?1:0,x=(a,b)=>{const e=Math.min(a.length,b.length);for(let i=0;i<e;i+=1){const e=E(a[i],b[i]);if(0!==e)return e}return k(a.length,b.length)},E=(a,b,e)=>{const t=e||k;if(void 0===a)return void 0===b?0:-1;if(void 0===b)return 1;if(null===a)return null===b?0:-1;if(null===b)return 1;if("number"==typeof a)return"number"==typeof b?k(a,b):-1;if("number"==typeof b)return"number"==typeof a?k(a,b):1;if("string"==typeof a)return"string"==typeof b?t(a,b):-1;if("string"==typeof b)return"string"==typeof a?t(a,b):1;if("boolean"==typeof a)return"boolean"==typeof b?k(a,b):-1;if("boolean"==typeof b)return"boolean"==typeof a?k(a,b):1;if(o(a))return o(b)?k(a.getTime(),b.getTime()):-1;if(o(b))return o(a)?k(a.getTime(),b.getTime()):1;if(Array.isArray(a))return Array.isArray(b)?x(a,b):-1;if(Array.isArray(b))return Array.isArray(a)?x(a,b):1;const r=Object.keys(a).sort(),n=Object.keys(b).sort();for(let i=0;i<Math.min(r.length,n.length);i+=1){const e=E(a[r[i]],b[n[i]]);if(0!==e)return e}return k(r.length,n.length)};f.$set=(e,t,r)=>{e[t]=r},f.$unset=(e,t,r)=>{delete e[t]},f.$push=(e,t,r)=>{if(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),!Array.isArray(e[t]))throw new Error("Can't $push an element on non-array values");if(null!==r&&"object"==typeof r&&r.$slice&&void 0===r.$each&&(r.$each=[]),null!==r&&"object"==typeof r&&r.$each){if(Object.keys(r).length>=3||2===Object.keys(r).length&&void 0===r.$slice)throw new Error("Can only use $slice in cunjunction with $each when $push to array");if(!Array.isArray(r.$each))throw new Error("$each requires an array value");if(r.$each.forEach((r=>{e[t].push(r)})),void 0===r.$slice||"number"!=typeof r.$slice)return;if(0===r.$slice)e[t]=[];else{let n,o;const c=e[t].length;r.$slice<0?(n=Math.max(0,c+r.$slice),o=c):r.$slice>0&&(n=0,o=Math.min(c,r.$slice)),e[t]=e[t].slice(n,o)}}else e[t].push(r)},f.$addToSet=(e,t,r)=>{if(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),!Array.isArray(e[t]))throw new Error("Can't $addToSet an element on non-array values");if(null!==r&&"object"==typeof r&&r.$each){if(Object.keys(r).length>1)throw new Error("Can't use another field in conjunction with $each");if(!Array.isArray(r.$each))throw new Error("$each requires an array value");r.$each.forEach((r=>{f.$addToSet(e,t,r)}))}else{let n=!0;e[t].forEach((e=>{0===E(e,r)&&(n=!1)})),n&&e[t].push(r)}},f.$pop=(e,t,r)=>{if(!Array.isArray(e[t]))throw new Error("Can't $pop an element from non-array values");if("number"!=typeof r)throw new Error(`${r} isn't an integer, can't use it with $pop`);0!==r&&(e[t]=r>0?e[t].slice(0,e[t].length-1):e[t].slice(1))},f.$pull=(e,t,r)=>{if(!Array.isArray(e[t]))throw new Error("Can't $pull an element from non-array values");const n=e[t];for(let i=n.length-1;i>=0;i-=1)j(n[i],r)&&n.splice(i,1)},f.$inc=(e,t,r)=>{if("number"!=typeof r)throw new Error(`${r} must be a number`);if("number"!=typeof e[t]){if(Object.prototype.hasOwnProperty.call(e,t))throw new Error("Don't use the $inc modifier on non-number fields");e[t]=r}else e[t]+=r},f.$max=(e,t,r)=>{(void 0===e[t]||r>e[t])&&(e[t]=r)},f.$min=(e,t,r)=>{(void 0===e[t]||r<e[t])&&(e[t]=r)};Object.keys(f).forEach((e=>{l[e]=(e=>(t,r,n)=>{const o="string"==typeof r?r.split("."):r;if(1===o.length)f[e](t,r,n);else{if(void 0===t[o[0]]){if("$unset"===e)return;t[o[0]]={}}l[e](t[o[0]],o.slice(1),n)}})(e)}));const A=(e,t)=>{const r="string"==typeof t?t.split("."):t;if(e){if(0===r.length)return e;if(1===r.length)return e[r[0]];if(Array.isArray(e[r[0]])){const i=parseInt(r[1],10);return"number"!=typeof i||isNaN(i)?e[r[0]].map((e=>A(e,r.slice(1)))):A(e[r[0]][i],r.slice(2))}return A(e[r[0]],r.slice(1))}},O=(a,b)=>{if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||null===b||"string"==typeof b||"boolean"==typeof b||"number"==typeof b)return a===b;if(o(a)||o(b))return o(a)&&o(b)&&a.getTime()===b.getTime();if((!Array.isArray(a)||!Array.isArray(b))&&(Array.isArray(a)||Array.isArray(b))||void 0===a||void 0===b)return!1;let e,t;try{e=Object.keys(a),t=Object.keys(b)}catch(e){return!1}if(e.length!==t.length)return!1;for(const r of e){if(-1===t.indexOf(r))return!1;if(!O(a[r],b[r]))return!1}return!0},I=(a,b)=>!("string"!=typeof a&&"number"!=typeof a&&!o(a)&&"string"!=typeof b&&"number"!=typeof b&&!o(b))&&typeof a==typeof b;h.$lt=(a,b)=>I(a,b)&&a<b,h.$lte=(a,b)=>I(a,b)&&a<=b,h.$gt=(a,b)=>I(a,b)&&a>b,h.$gte=(a,b)=>I(a,b)&&a>=b,h.$ne=(a,b)=>void 0===a||!O(a,b),h.$in=(a,b)=>{if(!Array.isArray(b))throw new Error("$in operator called with a non-array");for(const e of b)if(O(a,e))return!0;return!1},h.$nin=(a,b)=>{if(!Array.isArray(b))throw new Error("$nin operator called with a non-array");return!h.$in(a,b)},h.$regex=(a,b)=>{if(!c(b))throw new Error("$regex operator called with non regular expression");return"string"==typeof a&&b.test(a)},h.$exists=(e,t)=>(t=!(!t&&""!==t),void 0===e?!t:t),h.$size=(e,t)=>{if(!Array.isArray(e))return!1;if(t%1!=0)throw new Error("$size operator called without an integer");return e.length===t},h.$elemMatch=(e,t)=>!!Array.isArray(e)&&e.some((e=>j(e,t))),y.$size=!0,y.$elemMatch=!0,d.$or=(e,t)=>{if(!Array.isArray(t))throw new Error("$or operator used without an array");for(let i=0;i<t.length;i+=1)if(j(e,t[i]))return!0;return!1},d.$and=(e,t)=>{if(!Array.isArray(t))throw new Error("$and operator used without an array");for(let i=0;i<t.length;i+=1)if(!j(e,t[i]))return!1;return!0},d.$not=(e,t)=>!j(e,t),d.$where=(e,t)=>{if("function"!=typeof t)throw new Error("$where operator used without a function");const r=t.call(e);if("boolean"!=typeof r)throw new Error("$where function must return boolean");return r};const j=(e,t)=>{if(_(e)||_(t))return $({needAKey:e},"needAKey",t);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){const n=t[r];if("$"===r[0]){if(!d[r])throw new Error(`Unknown logical operator ${r}`);if(!d[r](e,n))return!1}else if(!$(e,r,n))return!1}return!0};function $(e,t,r,n){const o=A(e,t);if(Array.isArray(o)&&!n){if(Array.isArray(r))return $(e,t,r,!0);if(null!==r&&"object"==typeof r&&!c(r))for(const n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&y[n])return $(e,t,r,!0);for(const e of o)if($({k:e},"k",r))return!0;return!1}if(null!==r&&"object"==typeof r&&!c(r)&&!Array.isArray(r)){const e=Object.keys(r),t=e.map((e=>e[0])),n=t.filter((e=>"$"===e));if(0!==n.length&&n.length!==t.length)throw new Error("You cannot mix operators and normal fields");if(n.length>0){for(const t of e){if(!h[t])throw new Error(`Unknown comparison function ${t}`);if(!h[t](o,r[t]))return!1}return!0}}return c(r)?h.$regex(o,r):O(o,r)}e.exports.serialize=e=>JSON.stringify(e,(function(e,t){if(v(e,t),void 0!==t)return null===t?null:"function"==typeof this[e].getTime?{$$date:this[e].getTime()}:t})),e.exports.deserialize=e=>JSON.parse(e,(function(e,t){return"$$date"===e?new Date(t):"string"==typeof t||"number"==typeof t||"boolean"==typeof t||null===t?t:t&&t.$$date?t.$$date:t})),e.exports.deepCopy=w,e.exports.checkObject=m,e.exports.isPrimitiveType=_,e.exports.modify=(e,t)=>{const r=Object.keys(t),o=r.map((e=>e[0])),c=o.filter((e=>"$"===e));let f,h;if(-1!==r.indexOf("_id")&&t._id!==e._id)throw new Error("You cannot change a document's _id");if(0!==c.length&&c.length!==o.length)throw new Error("You cannot mix modifiers and normal fields");if(0===c.length?(f=w(t),f._id=e._id):(h=n(r),f=w(e),h.forEach((e=>{if(!l[e])throw new Error(`Unknown modifier ${e}`);if("object"!=typeof t[e])throw new Error(`Modifier ${e}'s argument must be an object`);Object.keys(t[e]).forEach((r=>{l[e](f,r,t[e][r])}))}))),m(f),e._id!==f._id)throw new Error("You can't change a document's _id");return f},e.exports.getDotValue=A,e.exports.match=j,e.exports.areThingsEqual=O,e.exports.compareThings=E},393:function(e,t){const r=e=>Object.prototype.toString.call(e),n=e=>"object"==typeof e&&null!==e;e.exports.uniq=(e,t)=>t?[...new Map(e.map((e=>[t(e),e]))).values()]:[...new Set(e)],e.exports.isDate=e=>n(e)&&"[object Date]"===r(e),e.exports.isRegExp=e=>n(e)&&"[object RegExp]"===r(e)},394:function(e,t,r){(function(r,n){var o;!function(){var c,l,f={};function h(e){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,e.apply(c,arguments)}}null!=(c=this)&&(l=c.async),f.noConflict=function(){return c.async=l,f};var d=function(e,t){if(e.forEach)return e.forEach(t);for(var i=0;i<e.length;i+=1)t(e[i],i,e)},y=function(e,t){if(e.map)return e.map(t);var r=[];return d(e,(function(e,i,a){r.push(t(e,i,a))})),r},v=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t};void 0!==r&&r.nextTick?(f.nextTick=r.nextTick,f.setImmediate=void 0!==n?function(e){n(e)}:f.nextTick):"function"==typeof n?(f.nextTick=function(e){n(e)},f.setImmediate=f.nextTick):(f.nextTick=function(e){setTimeout(e,0)},f.setImmediate=f.nextTick),f.each=function(e,t,r){if(r=r||function(){},!e.length)return r();var n=0;d(e,(function(o){t(o,h((function(t){t?(r(t),r=function(){}):(n+=1)>=e.length&&r(null)})))}))},f.forEach=f.each,f.eachSeries=function(e,t,r){if(r=r||function(){},!e.length)return r();var n=0,o=function(){t(e[n],(function(t){t?(r(t),r=function(){}):(n+=1)>=e.length?r(null):o()}))};o()},f.forEachSeries=f.eachSeries,f.eachLimit=function(e,t,r,n){m(t).apply(null,[e,r,n])},f.forEachLimit=f.eachLimit;var m=function(e){return function(t,r,n){if(n=n||function(){},!t.length||e<=0)return n();var o=0,c=0,l=0;!function f(){if(o>=t.length)return n();for(;l<e&&c<t.length;)l+=1,r(t[(c+=1)-1],(function(e){e?(n(e),n=function(){}):(l-=1,(o+=1)>=t.length?n():f())}))}()}},w=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[f.each].concat(t))}},_=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[f.eachSeries].concat(t))}},k=function(e,t,r,n){var o=[];e(t=y(t,(function(e,i){return{index:i,value:e}})),(function(e,t){r(e.value,(function(r,n){o[e.index]=n,t(r)}))}),(function(e){n(e,o)}))};f.map=w(k),f.mapSeries=_(k),f.mapLimit=function(e,t,r,n){return x(t)(e,r,n)};var x=function(e){return function(e,t){return function(){var r=Array.prototype.slice.call(arguments);return t.apply(null,[m(e)].concat(r))}}(e,k)};f.reduce=function(e,t,r,n){f.eachSeries(e,(function(e,n){r(t,e,(function(e,r){t=r,n(e)}))}),(function(e){n(e,t)}))},f.inject=f.reduce,f.foldl=f.reduce,f.reduceRight=function(e,t,r,n){var o=y(e,(function(e){return e})).reverse();f.reduce(o,t,r,n)},f.foldr=f.reduceRight;var E=function(e,t,r,n){var o=[];e(t=y(t,(function(e,i){return{index:i,value:e}})),(function(e,t){r(e.value,(function(r){r&&o.push(e),t()}))}),(function(e){n(y(o.sort((function(a,b){return a.index-b.index})),(function(e){return e.value})))}))};f.filter=w(E),f.filterSeries=_(E),f.select=f.filter,f.selectSeries=f.filterSeries;var A=function(e,t,r,n){var o=[];e(t=y(t,(function(e,i){return{index:i,value:e}})),(function(e,t){r(e.value,(function(r){r||o.push(e),t()}))}),(function(e){n(y(o.sort((function(a,b){return a.index-b.index})),(function(e){return e.value})))}))};f.reject=w(A),f.rejectSeries=_(A);var O=function(e,t,r,n){e(t,(function(e,t){r(e,(function(r){r?(n(e),n=function(){}):t()}))}),(function(e){n()}))};f.detect=w(O),f.detectSeries=_(O),f.some=function(e,t,r){f.each(e,(function(e,n){t(e,(function(e){e&&(r(!0),r=function(){}),n()}))}),(function(e){r(!1)}))},f.any=f.some,f.every=function(e,t,r){f.each(e,(function(e,n){t(e,(function(e){e||(r(!1),r=function(){}),n()}))}),(function(e){r(!0)}))},f.all=f.every,f.sortBy=function(e,t,r){f.map(e,(function(e,r){t(e,(function(t,n){t?r(t):r(null,{value:e,criteria:n})}))}),(function(e,t){if(e)return r(e);r(null,y(t.sort((function(e,t){var a=e.criteria,b=t.criteria;return a<b?-1:a>b?1:0})),(function(e){return e.value})))}))},f.auto=function(e,t){t=t||function(){};var r=v(e);if(!r.length)return t(null);var n={},o=[],c=function(e){o.unshift(e)},l=function(){d(o.slice(0),(function(e){e()}))};c((function(){v(n).length===r.length&&(t(null,n),t=function(){})})),d(r,(function(r){var h=e[r]instanceof Function?[e[r]]:e[r],y=function(e){var o=Array.prototype.slice.call(arguments,1);if(o.length<=1&&(o=o[0]),e){var c={};d(v(n),(function(e){c[e]=n[e]})),c[r]=o,t(e,c),t=function(){}}else n[r]=o,f.setImmediate(l)},m=h.slice(0,Math.abs(h.length-1))||[],w=function(){return t=function(a,e){return a&&n.hasOwnProperty(e)},o=!0,((e=m).reduce?e.reduce(t,o):(d(e,(function(e,i,a){o=t(o,e,i,a)})),o))&&!n.hasOwnProperty(r);var e,t,o};if(w())h[h.length-1](y,n);else{var _=function(){w()&&(!function(e){for(var i=0;i<o.length;i+=1)if(o[i]===e)return void o.splice(i,1)}(_),h[h.length-1](y,n))};c(_)}}))},f.waterfall=function(e,t){if(t=t||function(){},e.constructor!==Array){var r=new Error("First argument to waterfall must be an array of functions");return t(r)}if(!e.length)return t();var n=function(e){return function(r){if(r)t.apply(null,arguments),t=function(){};else{var o=Array.prototype.slice.call(arguments,1),c=e.next();c?o.push(n(c)):o.push(t),f.setImmediate((function(){e.apply(null,o)}))}}};n(f.iterator(e))()};var I=function(e,t,r){if(r=r||function(){},t.constructor===Array)e.map(t,(function(e,t){e&&e((function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),t.call(null,e,r)}))}),r);else{var n={};e.each(v(t),(function(e,r){t[e]((function(t){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),n[e]=o,r(t)}))}),(function(e){r(e,n)}))}};f.parallel=function(e,t){I({map:f.map,each:f.each},e,t)},f.parallelLimit=function(e,t,r){I({map:x(t),each:m(t)},e,r)},f.series=function(e,t){if(t=t||function(){},e.constructor===Array)f.mapSeries(e,(function(e,t){e&&e((function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),t.call(null,e,r)}))}),t);else{var r={};f.eachSeries(v(e),(function(t,n){e[t]((function(e){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),r[t]=o,n(e)}))}),(function(e){t(e,r)}))}},f.iterator=function(e){var t=function(r){var n=function(){return e.length&&e[r].apply(null,arguments),n.next()};return n.next=function(){return r<e.length-1?t(r+1):null},n};return t(0)},f.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var j=function(e,t,r,n){var o=[];e(t,(function(e,t){r(e,(function(e,r){o=o.concat(r||[]),t(e)}))}),(function(e){n(e,o)}))};f.concat=w(j),f.concatSeries=_(j),f.whilst=function(e,t,r){e()?t((function(n){if(n)return r(n);f.whilst(e,t,r)})):r()},f.doWhilst=function(e,t,r){e((function(n){if(n)return r(n);t()?f.doWhilst(e,t,r):r()}))},f.until=function(e,t,r){e()?r():t((function(n){if(n)return r(n);f.until(e,t,r)}))},f.doUntil=function(e,t,r){e((function(n){if(n)return r(n);t()?r():f.doUntil(e,t,r)}))},f.queue=function(e,t){function r(q,data,e,r){data.constructor!==Array&&(data=[data]),d(data,(function(n){var o={data:n,callback:"function"==typeof r?r:null};e?q.tasks.unshift(o):q.tasks.push(o),q.saturated&&q.tasks.length===t&&q.saturated(),f.setImmediate(q.process)}))}void 0===t&&(t=1);var n=0,q={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,push:function(data,e){r(q,data,!1,e)},unshift:function(data,e){r(q,data,!0,e)},process:function(){if(n<q.concurrency&&q.tasks.length){var t=q.tasks.shift();q.empty&&0===q.tasks.length&&q.empty(),n+=1;var r=h((function(){n-=1,t.callback&&t.callback.apply(t,arguments),q.drain&&q.tasks.length+n===0&&q.drain(),q.process()}));e(t.data,r)}},length:function(){return q.tasks.length},running:function(){return n}};return q},f.cargo=function(e,t){var r=!1,n=[],o={tasks:n,payload:t,saturated:null,empty:null,drain:null,push:function(data,e){data.constructor!==Array&&(data=[data]),d(data,(function(r){n.push({data:r,callback:"function"==typeof e?e:null}),o.saturated&&n.length===t&&o.saturated()})),f.setImmediate(o.process)},process:function c(){if(!r)if(0!==n.length){var l="number"==typeof t?n.splice(0,t):n.splice(0),f=y(l,(function(e){return e.data}));o.empty&&o.empty(),r=!0,e(f,(function(){r=!1;var e=arguments;d(l,(function(data){data.callback&&data.callback.apply(null,e)})),c()}))}else o.drain&&o.drain()},length:function(){return n.length},running:function(){return r}};return o};var $=function(e){return function(t){var r=Array.prototype.slice.call(arguments,1);t.apply(null,r.concat([function(t){var r=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&d(r,(function(t){console[e](t)})))}]))}};f.log=$("log"),f.dir=$("dir"),f.memoize=function(e,t){var r={},n={};t=t||function(e){return e};var o=function(){var o=Array.prototype.slice.call(arguments),c=o.pop(),l=t.apply(null,o);l in r?c.apply(null,r[l]):l in n?n[l].push(c):(n[l]=[c],e.apply(null,o.concat([function(){r[l]=arguments;var q=n[l];delete n[l];for(var i=0,e=q.length;i<e;i++)q[i].apply(null,arguments)}])))};return o.memo=r,o.unmemoized=e,o},f.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},f.times=function(e,t,r){for(var n=[],i=0;i<e;i++)n.push(i);return f.map(n,t,r)},f.timesSeries=function(e,t,r){for(var n=[],i=0;i<e;i++)n.push(i);return f.mapSeries(n,t,r)},f.compose=function(){var e=Array.prototype.reverse.call(arguments);return function(){var t=this,r=Array.prototype.slice.call(arguments),n=r.pop();f.reduce(e,r,(function(e,r,n){r.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);n(e,t)}]))}),(function(e,r){n.apply(t,[e].concat(r))}))}};var S=function(e,t){var r=function(){var r=this,n=Array.prototype.slice.call(arguments),o=n.pop();return e(t,(function(e,t){e.apply(r,n.concat([t]))}),o)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return r.apply(this,n)}return r};f.applyEach=w(S),f.applyEachSeries=_(S),f.forever=function(e,t){!function r(n){if(n){if(t)return t(n);throw n}e(r)}()},void 0===(o=function(){return f}.apply(t,[]))||(e.exports=o)}()}).call(this,r(182),r(254).setImmediate)},416:function(e,t,r){e.exports=r(430)},417:function(e,t,r){const n=r(390);e.exports=class{constructor(e,t,r){this.db=e,this.query=t||{},r&&(this.execFn=r)}limit(e){return this._limit=e,this}skip(e){return this._skip=e,this}sort(e){return this._sort=e,this}projection(e){return this._projection=e,this}project(e){const t=[];let r;if(void 0===this._projection||0===Object.keys(this._projection).length)return e;const o=0!==this._projection._id,{_id:c,...l}=this._projection;this._projection=l;const f=Object.keys(this._projection);return f.forEach((e=>{if(void 0!==r&&this._projection[e]!==r)throw new Error("Can't both keep and omit fields except for _id");r=this._projection[e]})),e.forEach((e=>{let c;1===r?(c={$set:{}},f.forEach((t=>{c.$set[t]=n.getDotValue(e,t),void 0===c.$set[t]&&delete c.$set[t]})),c=n.modify({},c)):(c={$unset:{}},f.forEach((e=>{c.$unset[e]=!0})),c=n.modify(e,c)),o?c._id=e._id:delete c._id,t.push(c)})),t}_exec(e){let t,r,o=[],c=0,l=0,f=null;const h=(t,r)=>this.execFn?this.execFn(t,r,e):e(t,r);this.db.getCandidates(this.query,((e,d)=>{if(e)return h(e);try{for(const e of d)if(n.match(e,this.query))if(this._sort)o.push(e);else if(this._skip&&this._skip>l)l+=1;else if(o.push(e),c+=1,this._limit&&this._limit<=c)break}catch(e){return h(e)}if(this._sort){t=Object.keys(this._sort);const e=[];t.forEach((t=>{r=t,e.push({key:r,direction:this._sort[r]})})),o.sort(((a,b)=>{for(const t of e){const e=t.direction*n.compareThings(n.getDotValue(a,t.key),n.getDotValue(b,t.key),this.db.compareStrings);if(0!==e)return e}return 0}));const c=this._limit||o.length,l=this._skip||0;o=o.slice(l,l+c)}try{o=this.project(o)}catch(e){f=e,o=void 0}return h(f,o)}))}exec(){this.db.executor.push({this:this,fn:this._exec,arguments:arguments})}}},418:function(e,t,r){"use strict";var n,o="object"==typeof Reflect?Reflect:null,c=o&&"function"==typeof o.apply?o.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var l=Number.isNaN||function(e){return e!=e};function f(){f.init.call(this)}e.exports=f,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,c),n(r)}function c(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}E(e,t,c,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&E(e,"error",t,r)}(e,o,{once:!0})}))},f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var h=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function y(e){return void 0===e._maxListeners?f.defaultMaxListeners:e._maxListeners}function v(e,t,r,n){var o,c,l,f;if(d(r),void 0===(c=e._events)?(c=e._events=Object.create(null),e._eventsCount=0):(void 0!==c.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),c=e._events),l=c[t]),void 0===l)l=c[t]=r,++e._eventsCount;else if("function"==typeof l?l=c[t]=n?[r,l]:[l,r]:n?l.unshift(r):l.push(r),(o=y(e))>0&&l.length>o&&!l.warned){l.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=l.length,f=h,console&&console.warn&&console.warn(f)}return e}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=m.bind(n);return o.listener=r,n.wrapFn=o,o}function _(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(o):x(o,o.length)}function k(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function x(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function E(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(c){n.once&&e.removeEventListener(t,o),r(c)}))}}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(e){if("number"!=typeof e||e<0||l(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");h=e}}),f.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||l(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},f.prototype.getMaxListeners=function(){return y(this)},f.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var l=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw l.context=o,l}var f=n[e];if(void 0===f)return!1;if("function"==typeof f)c(f,this,t);else{var h=f.length,d=x(f,h);for(i=0;i<h;++i)c(d[i],this,t)}return!0},f.prototype.addListener=function(e,t){return v(this,e,t,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(e,t){return v(this,e,t,!0)},f.prototype.once=function(e,t){return d(t),this.on(e,w(this,e,t)),this},f.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,w(this,e,t)),this},f.prototype.removeListener=function(e,t){var r,n,o,i,c;if(d(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){c=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,c||t)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,o=Object.keys(r);for(i=0;i<o.length;++i)"removeListener"!==(n=o[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},f.prototype.listeners=function(e){return _(this,e,!0)},f.prototype.rawListeners=function(e){return _(this,e,!1)},f.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):k.call(e,t)},f.prototype.listenerCount=k,f.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},419:function(e,t){e.exports.uid=e=>(e=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=e.length%3;let n,output="";for(let i=0,c=e.length-r;i<c;i+=3)n=(e[i]<<16)+(e[i+1]<<8)+e[i+2],output+=t[(o=n)>>18&63]+t[o>>12&63]+t[o>>6&63]+t[63&o];var o;return 1===r?(n=e[e.length-1],output+=t[n>>2],output+=t[n<<4&63],output+="=="):2===r&&(n=(e[e.length-2]<<8)+e[e.length-1],output+=t[n>>10],output+=t[n>>4&63],output+=t[n<<2&63],output+="="),output})((e=>{const t=new Array(e);for(let r,i=0;i<e;i++)0==(3&i)&&(r=4294967296*Math.random()),t[i]=r>>>((3&i)<<3)&255;return t})(Math.ceil(Math.max(8,2*e)))).replace(/[+/]/g,"").slice(0,e)},420:function(e,t,r){const n=r(435).AVLTree,o=r(390),{uniq:c,isDate:l}=r(393),f=(a,b)=>a===b;function h(e){return null===e?"$null":"string"==typeof e?"$string"+e:"boolean"==typeof e?"$boolean"+e:"number"==typeof e?"$number"+e:l(e)?"$date"+e.getTime():e}e.exports=class{constructor(e){this.fieldName=e.fieldName,this.unique=e.unique||!1,this.sparse=e.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:o.compareThings,checkValueEquality:f},this.reset()}reset(e){this.tree=new n(this.treeOptions),e&&this.insert(e)}insert(e){let t,r,n;if(Array.isArray(e))return void this.insertMultipleDocs(e);const l=o.getDotValue(e,this.fieldName);if(void 0!==l||!this.sparse)if(Array.isArray(l)){t=c(l,h);for(let i=0;i<t.length;i+=1)try{this.tree.insert(t[i],e)}catch(e){n=e,r=i;break}if(n){for(let i=0;i<r;i+=1)this.tree.delete(t[i],e);throw n}}else this.tree.insert(l,e)}insertMultipleDocs(e){let t,r;for(let i=0;i<e.length;i+=1)try{this.insert(e[i])}catch(e){t=e,r=i;break}if(t){for(let i=0;i<r;i+=1)this.remove(e[i]);throw t}}remove(e){if(Array.isArray(e))return void e.forEach((e=>{this.remove(e)}));const t=o.getDotValue(e,this.fieldName);void 0===t&&this.sparse||(Array.isArray(t)?c(t,h).forEach((t=>{this.tree.delete(t,e)})):this.tree.delete(t,e))}update(e,t){if(Array.isArray(e))this.updateMultipleDocs(e);else{this.remove(e);try{this.insert(t)}catch(t){throw this.insert(e),t}}}updateMultipleDocs(e){let t,r;for(let i=0;i<e.length;i+=1)this.remove(e[i].oldDoc);for(let i=0;i<e.length;i+=1)try{this.insert(e[i].newDoc)}catch(e){r=e,t=i;break}if(r){for(let i=0;i<t;i+=1)this.remove(e[i].newDoc);for(let i=0;i<e.length;i+=1)this.insert(e[i].oldDoc);throw r}}revertUpdate(e,t){const r=[];Array.isArray(e)?(e.forEach((e=>{r.push({oldDoc:e.newDoc,newDoc:e.oldDoc})})),this.update(r)):this.update(t,e)}getMatching(e){if(Array.isArray(e)){const t={},r=[];return e.forEach((e=>{this.getMatching(e).forEach((e=>{t[e._id]=e}))})),Object.keys(t).forEach((e=>{r.push(t[e])})),r}return this.tree.search(e)}getBetweenBounds(e){return this.tree.betweenBounds(e)}getAll(){const e=[];return this.tree.executeOnEveryNode((t=>{e.push(...t.data)})),e}}},421:function(e,t,r){const n=r(422);function o(e,t){for(let i=0;i<t.length;i+=1)e.push(t[i])}e.exports=class{constructor(e){e=e||{},this.left=null,this.right=null,this.parent=void 0!==e.parent?e.parent:null,Object.prototype.hasOwnProperty.call(e,"key")&&(this.key=e.key),this.data=Object.prototype.hasOwnProperty.call(e,"value")?[e.value]:[],this.unique=e.unique||!1,this.compareKeys=e.compareKeys||n.defaultCompareKeysFunction,this.checkValueEquality=e.checkValueEquality||n.defaultCheckValueEquality}getMaxKeyDescendant(){return this.right?this.right.getMaxKeyDescendant():this}getMaxKey(){return this.getMaxKeyDescendant().key}getMinKeyDescendant(){return this.left?this.left.getMinKeyDescendant():this}getMinKey(){return this.getMinKeyDescendant().key}checkAllNodesFullfillCondition(e){Object.prototype.hasOwnProperty.call(this,"key")&&(e(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(e),this.right&&this.right.checkAllNodesFullfillCondition(e))}checkNodeOrdering(){Object.prototype.hasOwnProperty.call(this,"key")&&(this.left&&(this.left.checkAllNodesFullfillCondition((e=>{if(this.compareKeys(e,this.key)>=0)throw new Error(`Tree with root ${this.key} is not a binary search tree`)})),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition((e=>{if(this.compareKeys(e,this.key)<=0)throw new Error(`Tree with root ${this.key} is not a binary search tree`)})),this.right.checkNodeOrdering()))}checkInternalPointers(){if(this.left){if(this.left.parent!==this)throw new Error(`Parent pointer broken for key ${this.key}`);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error(`Parent pointer broken for key ${this.key}`);this.right.checkInternalPointers()}}checkIsBST(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")}getNumberOfKeys(){let e;return Object.prototype.hasOwnProperty.call(this,"key")?(e=1,this.left&&(e+=this.left.getNumberOfKeys()),this.right&&(e+=this.right.getNumberOfKeys()),e):0}createSimilar(e){return(e=e||{}).unique=this.unique,e.compareKeys=this.compareKeys,e.checkValueEquality=this.checkValueEquality,new this.constructor(e)}createLeftChild(e){const t=this.createSimilar(e);return t.parent=this,this.left=t,t}createRightChild(e){const t=this.createSimilar(e);return t.parent=this,this.right=t,t}insert(e,t){if(!Object.prototype.hasOwnProperty.call(this,"key"))return this.key=e,void this.data.push(t);if(0!==this.compareKeys(this.key,e))this.compareKeys(e,this.key)<0?this.left?this.left.insert(e,t):this.createLeftChild({key:e,value:t}):this.right?this.right.insert(e,t):this.createRightChild({key:e,value:t});else{if(this.unique){const t=new Error(`Can't insert key ${e}, it violates the unique constraint`);throw t.key=e,t.errorType="uniqueViolated",t}this.data.push(t)}}search(e){return Object.prototype.hasOwnProperty.call(this,"key")?0===this.compareKeys(this.key,e)?this.data:this.compareKeys(e,this.key)<0?this.left?this.left.search(e):[]:this.right?this.right.search(e):[]:[]}getLowerBoundMatcher(e){return Object.prototype.hasOwnProperty.call(e,"$gt")||Object.prototype.hasOwnProperty.call(e,"$gte")?Object.prototype.hasOwnProperty.call(e,"$gt")&&Object.prototype.hasOwnProperty.call(e,"$gte")?0===this.compareKeys(e.$gte,e.$gt)?t=>this.compareKeys(t,e.$gt)>0:this.compareKeys(e.$gte,e.$gt)>0?t=>this.compareKeys(t,e.$gte)>=0:t=>this.compareKeys(t,e.$gt)>0:Object.prototype.hasOwnProperty.call(e,"$gt")?t=>this.compareKeys(t,e.$gt)>0:t=>this.compareKeys(t,e.$gte)>=0:()=>!0}getUpperBoundMatcher(e){return Object.prototype.hasOwnProperty.call(e,"$lt")||Object.prototype.hasOwnProperty.call(e,"$lte")?Object.prototype.hasOwnProperty.call(e,"$lt")&&Object.prototype.hasOwnProperty.call(e,"$lte")?0===this.compareKeys(e.$lte,e.$lt)?t=>this.compareKeys(t,e.$lt)<0:this.compareKeys(e.$lte,e.$lt)<0?t=>this.compareKeys(t,e.$lte)<=0:t=>this.compareKeys(t,e.$lt)<0:Object.prototype.hasOwnProperty.call(e,"$lt")?t=>this.compareKeys(t,e.$lt)<0:t=>this.compareKeys(t,e.$lte)<=0:()=>!0}betweenBounds(e,t,r){const n=[];return Object.prototype.hasOwnProperty.call(this,"key")?(t=t||this.getLowerBoundMatcher(e),r=r||this.getUpperBoundMatcher(e),t(this.key)&&this.left&&o(n,this.left.betweenBounds(e,t,r)),t(this.key)&&r(this.key)&&o(n,this.data),r(this.key)&&this.right&&o(n,this.right.betweenBounds(e,t,r)),n):[]}deleteIfLeaf(){return!this.left&&!this.right&&(this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.data=[],!0))}deleteIfOnlyOneChild(){let e;return this.left&&!this.right&&(e=this.left),!this.left&&this.right&&(e=this.right),!!e&&(this.parent?(this.parent.left===this?(this.parent.left=e,e.parent=this.parent):(this.parent.right=e,e.parent=this.parent),!0):(this.key=e.key,this.data=e.data,this.left=null,e.left&&(this.left=e.left,e.left.parent=this),this.right=null,e.right&&(this.right=e.right,e.right.parent=this),!0))}delete(e,t){const r=[];let n;if(Object.prototype.hasOwnProperty.call(this,"key"))if(this.compareKeys(e,this.key)<0)this.left&&this.left.delete(e,t);else if(this.compareKeys(e,this.key)>0)this.right&&this.right.delete(e,t);else if(0!==!this.compareKeys(e,this.key))return this.data.length>1&&void 0!==t?(this.data.forEach((e=>{this.checkValueEquality(e,t)||r.push(e)})),void(this.data=r)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(n=this.left.getMaxKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.left=n.left,n.left&&(n.left.parent=n.parent)):(n.parent.right=n.left,n.left&&(n.left.parent=n.parent))):(n=this.right.getMinKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.right=n.right,n.right&&(n.right.parent=n.parent)):(n.parent.left=n.right,n.right&&(n.right.parent=n.parent)))))}executeOnEveryNode(e){this.left&&this.left.executeOnEveryNode(e),e(this),this.right&&this.right.executeOnEveryNode(e)}prettyPrint(e,t){t=t||"",console.log(`${t}* ${this.key}`),e&&console.log(`${t}* ${this.data}`),(this.left||this.right)&&(this.left?this.left.prettyPrint(e,`${t}  `):console.log(`${t}  *`),this.right?this.right.prettyPrint(e,`${t}  `):console.log(`${t}  *`))}}},422:function(e,t){const r=e=>{if(0===e)return[];if(1===e)return[0];const t=r(e-1),n=Math.floor(Math.random()*e);return t.splice(n,0,e-1),t};e.exports.getRandomArray=r;e.exports.defaultCompareKeysFunction=(a,b)=>{if(a<b)return-1;if(a>b)return 1;if(a===b)return 0;const e=new Error("Couldn't compare elements");throw e.a=a,e.b=b,e};e.exports.defaultCheckValueEquality=(a,b)=>a===b},430:function(e,t,r){const n=r(431),o=r(418),c=r(432);e.exports=class extends o{constructor(e){super(),Object.defineProperties(this,{__loaded:{enumerable:!1,writable:!0,value:null},__original:{configurable:!0,enumerable:!1,writable:!1,value:new c(e)}}),this.__original.on("compaction.done",(()=>{this.emit("compactionDone",this)}))}load(){return this.__loaded instanceof Promise||(this.__loaded=new Promise(((e,t)=>{this.__original.loadDatabase((r=>{r?(this.emit("loadError",this,r),this.emit("__error__",this,"load",r),t(r)):(this.emit("load",this),e())}))}))),this.__loaded}find(e={},t){return"function"==typeof t&&(t={}),new n(this.__original.find(e,t),this.load(),((r,n)=>{r?(this.emit("findError",this,r,e,t),this.emit("__error__",this,"find",r,e,t)):this.emit("find",this,n,e,t)}))}findOne(e={},t){return"function"==typeof t&&(t={}),new n(this.__original.findOne(e,t),this.load(),((r,n)=>{r?(this.emit("findOneError",this,r,e,t),this.emit("__error__",this,"findOne",r,e,t)):this.emit("findOne",this,n,e,t)}))}insert(e){return this.load().then((()=>new Promise(((t,r)=>{this.__original.insert(e,((n,o)=>{n?(this.emit("insertError",this,n,e),this.emit("__error__",this,"insert",n,e),r(n)):(this.emit("insert",this,o,e),t(o))}))}))))}update(e,t,r={}){return this.load().then((()=>new Promise(((n,o)=>{this.__original.update(e,t,r,((c,l,f,h)=>{if(c)this.emit("updateError",this,c,e,t,r),this.emit("__error__",this,"update",c,e,t,r),o(c);else{let o=r.returnUpdatedDocs?f:l;this.emit("update",this,o,e,t,r),n(o)}}))}))))}remove(e={},t={}){return this.load().then((()=>new Promise(((r,n)=>{this.__original.remove(e,t,((o,c)=>{o?(this.emit("removeError",this,o,e,t),this.emit("__error__",this,"remove",o,e,t),n(o)):(this.emit("remove",this,c,e,t),r(c))}))}))))}count(e={}){return new n(this.__original.count(e),this.load(),((t,r)=>{t?(this.emit("countError",this,t,e),this.emit("__error__",this,"count",t,e)):this.emit("count",this,r,e)}))}ensureIndex(e){return new Promise(((t,r)=>{this.__original.ensureIndex(e,(n=>{n?(this.emit("ensureIndexError",this,n,e),this.emit("__error__",this,"ensureIndex",n,e),r(n)):(this.emit("ensureIndex",this,e),t())}))}))}removeIndex(e){return new Promise(((t,r)=>{this.__original.removeIndex(e,(n=>{n?(this.emit("removeIndexError",this,n,e),this.emit("__error__",this,"removeIndex",n,e),r(n)):(this.emit("removeIndex",this,e),t())}))}))}static create(e){return new Proxy(new this(e),{get:(e,t)=>e[t]?e[t]:e.__original[t],set:(e,t,r)=>e.__original.hasOwnProperty(t)?e.__original[t]=r:e[t]=r})}}},431:function(e,t,r){const n=r(417);e.exports=class{constructor(e,t,r){if(!(e instanceof n))throw new TypeError(`Unexpected ${typeof e}, expected: Cursor (nedb/lib/cursor)`);t instanceof Promise||(t=Promise.resolve()),Object.defineProperties(this,{__original:{configurable:!1,enumerable:!1,writable:!1,value:e},__prerequisite:{configurable:!1,enumerable:!1,writable:!1,value:t},__callback:{configurable:!1,enumerable:!1,writable:!1,value:r}})}sort(){return this.__original.sort.apply(this.__original,arguments),this}skip(){return this.__original.skip.apply(this.__original,arguments),this}limit(){return this.__original.limit.apply(this.__original,arguments),this}exec(){return this.__prerequisite.then((()=>new Promise(((e,t)=>{this.__original.exec(((r,n)=>("function"==typeof this.__callback&&this.__callback(r,n),r?t(r):e(n))))}))))}then(e,t){return this.exec().then(e,t)}catch(e){return this.exec().catch(e)}}},432:function(e,t,r){const n=r(433);e.exports=n},433:function(e,t,r){const{EventEmitter:n}=r(418),o=r(394),c=r(417),l=r(419),f=r(434),h=r(420),d=r(390),y=r(437),{isDate:v}=r(393);e.exports=class extends n{constructor(e){let t;super(),"string"==typeof e?(t=e,this.inMemoryOnly=!1):(t=(e=e||{}).filename,this.inMemoryOnly=e.inMemoryOnly||!1,this.autoload=e.autoload||!1,this.timestampData=e.timestampData||!1),t&&"string"==typeof t&&0!==t.length?this.filename=t:(this.filename=null,this.inMemoryOnly=!0),this.compareStrings=e.compareStrings,this.persistence=new y({db:this,nodeWebkitAppName:e.nodeWebkitAppName,afterSerialization:e.afterSerialization,beforeDeserialization:e.beforeDeserialization,corruptAlertThreshold:e.corruptAlertThreshold}),this.executor=new f,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new h({fieldName:"_id",unique:!0}),this.ttlIndexes={},this.autoload&&this.loadDatabase(e.onload||(e=>{if(e)throw e}))}loadDatabase(){this.executor.push({this:this.persistence,fn:this.persistence.loadDatabase,arguments:arguments},!0)}getAllData(){return this.indexes._id.getAll()}resetIndexes(e){for(const t of Object.values(this.indexes))t.reset(e)}ensureIndex(e={},t=(()=>{})){if(!e.fieldName){const e=new Error("Cannot create an index without a fieldName");return e.missingFieldName=!0,t(e)}if(this.indexes[e.fieldName])return t(null);this.indexes[e.fieldName]=new h(e),void 0!==e.expireAfterSeconds&&(this.ttlIndexes[e.fieldName]=e.expireAfterSeconds);try{this.indexes[e.fieldName].insert(this.getAllData())}catch(r){return delete this.indexes[e.fieldName],t(r)}this.persistence.persistNewState([{$$indexCreated:e}],(e=>t(e||null)))}removeIndex(e,t=(()=>{})){delete this.indexes[e],this.persistence.persistNewState([{$$indexRemoved:e}],(e=>t(e||null)))}addToIndexes(e){let t,r;const n=Object.keys(this.indexes);for(let i=0;i<n.length;i+=1)try{this.indexes[n[i]].insert(e)}catch(e){t=i,r=e;break}if(r){for(let i=0;i<t;i+=1)this.indexes[n[i]].remove(e);throw r}}removeFromIndexes(e){for(const t of Object.values(this.indexes))t.remove(e)}updateIndexes(e,t){let r,n;const o=Object.keys(this.indexes);for(let i=0;i<o.length;i+=1)try{this.indexes[o[i]].update(e,t)}catch(e){r=i,n=e;break}if(n){for(let i=0;i<r;i+=1)this.indexes[o[i]].revertUpdate(e,t);throw n}}getCandidates(e,t,r){const n=Object.keys(this.indexes);let c;"function"==typeof t&&(r=t,t=!1),o.waterfall([t=>(c=[],Object.keys(e).forEach((t=>{("string"==typeof e[t]||"number"==typeof e[t]||"boolean"==typeof e[t]||v(e[t])||null===e[t])&&c.push(t)})),c=c.filter((e=>n.includes(e))),c.length>0?t(null,this.indexes[c[0]].getMatching(e[c[0]])):(c=[],Object.keys(e).forEach((t=>{e[t]&&Object.prototype.hasOwnProperty.call(e[t],"$in")&&c.push(t)})),c=c.filter((e=>n.includes(e))),c.length>0?t(null,this.indexes[c[0]].getMatching(e[c[0]].$in)):(c=[],Object.keys(e).forEach((t=>{e[t]&&(Object.prototype.hasOwnProperty.call(e[t],"$lt")||Object.prototype.hasOwnProperty.call(e[t],"$lte")||Object.prototype.hasOwnProperty.call(e[t],"$gt")||Object.prototype.hasOwnProperty.call(e[t],"$gte"))&&c.push(t)})),c=c.filter((e=>n.includes(e))),c.length>0?t(null,this.indexes[c[0]].getBetweenBounds(e[c[0]])):t(null,this.getAllData())))),e=>{if(t)return r(null,e);const n=[],c=[],l=Object.keys(this.ttlIndexes);e.forEach((e=>{let t=!0;l.forEach((i=>{void 0!==e[i]&&v(e[i])&&Date.now()>e[i].getTime()+1e3*this.ttlIndexes[i]&&(t=!1)})),t?c.push(e):n.push(e._id)})),o.eachSeries(n,((e,t)=>{this._remove({_id:e},{},(e=>e?r(e):t()))}),(e=>r(null,c)))}])}_insert(e,t=(()=>{})){let r;try{r=this.prepareDocumentForInsertion(e),this._insertInCache(r)}catch(e){return t(e)}this.persistence.persistNewState(Array.isArray(r)?r:[r],(e=>e?t(e):t(null,d.deepCopy(r))))}createNewId(){let e=l.uid(16);return this.indexes._id.getMatching(e).length>0&&(e=this.createNewId()),e}prepareDocumentForInsertion(e){let t;if(Array.isArray(e))t=[],e.forEach((e=>{t.push(this.prepareDocumentForInsertion(e))}));else{t=d.deepCopy(e),void 0===t._id&&(t._id=this.createNewId());const r=new Date;this.timestampData&&void 0===t.createdAt&&(t.createdAt=r),this.timestampData&&void 0===t.updatedAt&&(t.updatedAt=r),d.checkObject(t)}return t}_insertInCache(e){Array.isArray(e)?this._insertMultipleDocsInCache(e):this.addToIndexes(e)}_insertMultipleDocsInCache(e){let t,r;for(let i=0;i<e.length;i+=1)try{this.addToIndexes(e[i])}catch(e){r=e,t=i;break}if(r){for(let i=0;i<t;i+=1)this.removeFromIndexes(e[i]);throw r}}insert(){this.executor.push({this:this,fn:this._insert,arguments:arguments})}count(e,t){const cursor=new c(this,e,(function(e,t,r){return e?r(e):r(null,t.length)}));if("function"!=typeof t)return cursor;cursor.exec(t)}find(e,t,r){1===arguments.length?t={}:2===arguments.length&&"function"==typeof t&&(r=t,t={});const cursor=new c(this,e,(function(e,t,r){if(e)return r(e);return r(null,t.map((e=>d.deepCopy(e))))}));if(cursor.projection(t),"function"!=typeof r)return cursor;cursor.exec(r)}findOne(e,t,r){1===arguments.length?t={}:2===arguments.length&&"function"==typeof t&&(r=t,t={});const cursor=new c(this,e,((e,t,r)=>e?r(e):1===t.length?r(null,d.deepCopy(t[0])):r(null,null)));if(cursor.projection(t).limit(1),"function"!=typeof r)return cursor;cursor.exec(r)}_update(e,t,r,n){"function"==typeof r&&(n=r,r={});const l=n||(()=>{}),f=void 0!==r.multi&&r.multi,h=void 0!==r.upsert&&r.upsert;o.waterfall([r=>{if(!h)return r();new c(this,e).limit(1)._exec(((n,o)=>{if(n)return l(n);if(1===o.length)return r();{let r;try{d.checkObject(t),r=t}catch(o){try{r=d.modify(d.deepCopy(e,!0),t)}catch(n){return l(n)}}return this._insert(r,((e,t)=>e?l(e):l(null,1,t,!0)))}}))},()=>{let n,o=0;const c=[];let h;this.getCandidates(e,((y,v)=>{if(y)return l(y);try{for(const r of v)d.match(r,e)&&(f||0===o)&&(o+=1,this.timestampData&&(h=r.createdAt),n=d.modify(r,t),this.timestampData&&(n.createdAt=h,n.updatedAt=new Date),c.push({oldDoc:r,newDoc:n}))}catch(y){return l(y)}try{this.updateIndexes(c)}catch(y){return l(y)}const m=c.map((e=>e.newDoc));this.persistence.persistNewState(m,(e=>{if(e)return l(e);if(r.returnUpdatedDocs){let e=[];return m.forEach((t=>{e.push(d.deepCopy(t))})),f||(e=e[0]),l(null,o,e)}return l(null,o)}))}))}])}update(){this.executor.push({this:this,fn:this._update,arguments:arguments})}_remove(e,t,r){"function"==typeof t&&(r=t,t={});const n=r||(()=>{}),o=void 0!==t.multi&&t.multi;this.getCandidates(e,!0,((t,r)=>{if(t)return n(t);const c=[];let l=0;try{r.forEach((t=>{d.match(t,e)&&(o||0===l)&&(l+=1,c.push({$$deleted:!0,_id:t._id}),this.removeFromIndexes(t))}))}catch(t){return n(t)}this.persistence.persistNewState(c,(e=>e?n(e):n(null,l)))}))}remove(){this.executor.push({this:this,fn:this._remove,arguments:arguments})}}},434:function(e,t,r){(function(t,n){const o=r(394);e.exports=class{constructor(){this.buffer=[],this.ready=!1,this.queue=o.queue(((e,r)=>{const o=Array.from(e.arguments),c=o[o.length-1];"function"==typeof c?o[o.length-1]=function(){"function"==typeof t?t(r):n.nextTick(r),c.apply(null,arguments)}:c||0===e.arguments.length?o.push((()=>{r()})):o[o.length-1]=()=>{r()},e.fn.apply(e.this,o)}),1)}push(e,t){this.ready||t?this.queue.push(e):this.buffer.push(e)}processBuffer(){this.ready=!0,this.buffer.forEach((e=>{this.queue.push(e)})),this.buffer=[]}}}).call(this,r(254).setImmediate,r(182))},435:function(e,t,r){e.exports.BinarySearchTree=r(421),e.exports.AVLTree=r(436)},436:function(e,t,r){const n=r(421),o=r(422);class c{constructor(e){this.tree=new l(e)}checkIsAVLT(){this.tree.checkIsAVLT()}insert(e,t){const r=this.tree.insert(e,t);r&&(this.tree=r)}delete(e,t){const r=this.tree.delete(e,t);r&&(this.tree=r)}}class l extends n{constructor(e){super(),e=e||{},this.left=null,this.right=null,this.parent=void 0!==e.parent?e.parent:null,Object.prototype.hasOwnProperty.call(e,"key")&&(this.key=e.key),this.data=Object.prototype.hasOwnProperty.call(e,"value")?[e.value]:[],this.unique=e.unique||!1,this.compareKeys=e.compareKeys||o.defaultCompareKeysFunction,this.checkValueEquality=e.checkValueEquality||o.defaultCheckValueEquality}checkHeightCorrect(){if(!Object.prototype.hasOwnProperty.call(this,"key"))return;if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);const e=this.left?this.left.height:0,t=this.right?this.right.height:0;if(this.height!==1+Math.max(e,t))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}balanceFactor(){return(this.left?this.left.height:0)-(this.right?this.right.height:0)}checkBalanceFactors(){if(Math.abs(this.balanceFactor())>1)throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()}checkIsAVLT(){super.checkIsBST(),this.checkHeightCorrect(),this.checkBalanceFactors()}rightRotation(){const q=this,p=this.left;if(!p)return q;const b=p.right;q.parent?(p.parent=q.parent,q.parent.left===q?q.parent.left=p:q.parent.right=p):p.parent=null,p.right=q,q.parent=p,q.left=b,b&&(b.parent=q);const e=p.left?p.left.height:0,t=b?b.height:0,r=q.right?q.right.height:0;return q.height=Math.max(t,r)+1,p.height=Math.max(e,q.height)+1,p}leftRotation(){const p=this,q=this.right;if(!q)return this;const b=q.left;p.parent?(q.parent=p.parent,p.parent.left===p?p.parent.left=q:p.parent.right=q):q.parent=null,q.left=p,p.parent=q,p.right=b,b&&(b.parent=p);const e=p.left?p.left.height:0,t=b?b.height:0,r=q.right?q.right.height:0;return p.height=Math.max(e,t)+1,q.height=Math.max(r,p.height)+1,q}rightTooSmall(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())}leftTooSmall(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())}rebalanceAlongPath(path){let e,i,t=this;if(!Object.prototype.hasOwnProperty.call(this,"key"))return delete this.height,this;for(i=path.length-1;i>=0;i-=1)path[i].height=1+Math.max(path[i].left?path[i].left.height:0,path[i].right?path[i].right.height:0),path[i].balanceFactor()>1&&(e=path[i].rightTooSmall(),0===i&&(t=e)),path[i].balanceFactor()<-1&&(e=path[i].leftTooSmall(),0===i&&(t=e));return t}insert(e,t){const r=[];let n=this;if(!Object.prototype.hasOwnProperty.call(this,"key"))return this.key=e,this.data.push(t),this.height=1,this;for(;;){if(0===n.compareKeys(n.key,e)){if(n.unique){const t=new Error(`Can't insert key ${e}, it violates the unique constraint`);throw t.key=e,t.errorType="uniqueViolated",t}return n.data.push(t),this}if(r.push(n),n.compareKeys(e,n.key)<0){if(!n.left){r.push(n.createLeftChild({key:e,value:t}));break}n=n.left}else{if(!n.right){r.push(n.createRightChild({key:e,value:t}));break}n=n.right}}return this.rebalanceAlongPath(r)}delete(e,t){const r=[];let n,o=this;const c=[];if(!Object.prototype.hasOwnProperty.call(this,"key"))return this;for(;0!==o.compareKeys(e,o.key);)if(c.push(o),o.compareKeys(e,o.key)<0){if(!o.left)return this;o=o.left}else{if(!o.right)return this;o=o.right}if(o.data.length>1&&void 0!==t)return o.data.forEach((function(e){o.checkValueEquality(e,t)||r.push(e)})),o.data=r,this;if(!o.left&&!o.right)return o===this?(delete o.key,o.data=[],delete o.height,this):(o.parent.left===o?o.parent.left=null:o.parent.right=null,this.rebalanceAlongPath(c));if(!o.left||!o.right)return n=o.left?o.left:o.right,o===this?(n.parent=null,n):(o.parent.left===o?(o.parent.left=n,n.parent=o.parent):(o.parent.right=n,n.parent=o.parent),this.rebalanceAlongPath(c));if(c.push(o),n=o.left,!n.right)return o.key=n.key,o.data=n.data,o.left=n.left,n.left&&(n.left.parent=o),this.rebalanceAlongPath(c);for(;n.right;)c.push(n),n=n.right;return o.key=n.key,o.data=n.data,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(c)}}c._AVLTree=l,["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach((function(e){c.prototype[e]=function(){return this.tree[e].apply(this.tree,arguments)}})),e.exports=c},437:function(e,t,r){(function(t){const path=r(438),n=r(394),o=r(419),c=r(420),l=r(390),f=r(439);class h{constructor(e){if(this.db=e.db,this.inMemoryOnly=this.db.inMemoryOnly,this.filename=this.db.filename,this.corruptAlertThreshold=void 0!==e.corruptAlertThreshold?e.corruptAlertThreshold:.1,!this.inMemoryOnly&&this.filename&&"~"===this.filename.charAt(this.filename.length-1))throw new Error("The datafile name can't end with a ~, which is reserved for crash safe backup files");if(e.afterSerialization&&!e.beforeDeserialization)throw new Error("Serialization hook defined but deserialization hook undefined, cautiously refusing to start NeDB to prevent dataloss");if(!e.afterSerialization&&e.beforeDeserialization)throw new Error("Serialization hook undefined but deserialization hook defined, cautiously refusing to start NeDB to prevent dataloss");this.afterSerialization=e.afterSerialization||(s=>s),this.beforeDeserialization=e.beforeDeserialization||(s=>s);for(let i=1;i<30;i+=1)for(let e=0;e<10;e+=1){const e=o.uid(i);if(this.beforeDeserialization(this.afterSerialization(e))!==e)throw new Error("beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NeDB to prevent dataloss")}this.filename&&e.nodeWebkitAppName&&(console.log("=================================================================="),console.log("WARNING: The nodeWebkitAppName option is deprecated"),console.log("To get the path to the directory where Node Webkit stores the data"),console.log("for your app, use the internal nw.gui module like this"),console.log("require('nw.gui').App.dataPath"),console.log("See https://github.com/rogerwang/node-webkit/issues/500"),console.log("=================================================================="),this.filename=h.getNWAppFilename(e.nodeWebkitAppName,this.filename))}persistCachedDatabase(e=(()=>{})){let t="";if(this.inMemoryOnly)return e(null);this.db.getAllData().forEach((e=>{t+=this.afterSerialization(l.serialize(e))+"\n"})),Object.keys(this.db.indexes).forEach((e=>{"_id"!==e&&(t+=this.afterSerialization(l.serialize({$$indexCreated:{fieldName:e,unique:this.db.indexes[e].unique,sparse:this.db.indexes[e].sparse}}))+"\n")})),f.crashSafeWriteFile(this.filename,t,(t=>t?e(t):(this.db.emit("compaction.done"),e(null))))}compactDatafile(){this.db.executor.push({this:this,fn:this.persistCachedDatabase,arguments:[]})}setAutocompactionInterval(e){const t=Math.max(e||0,5e3);this.stopAutocompaction(),this.autocompactionIntervalId=setInterval((()=>{this.compactDatafile()}),t)}stopAutocompaction(){this.autocompactionIntervalId&&clearInterval(this.autocompactionIntervalId)}persistNewState(e,t=(()=>{})){let r="";return this.inMemoryOnly?t(null):(e.forEach((e=>{r+=this.afterSerialization(l.serialize(e))+"\n"})),0===r.length?t(null):void f.appendFile(this.filename,r,"utf8",(e=>t(e))))}treatRawData(e){const data=e.split("\n"),t={},r=[],n={};let o=-1;for(const e of data)try{const r=l.deserialize(this.beforeDeserialization(e));r._id?!0===r.$$deleted?delete t[r._id]:t[r._id]=r:r.$$indexCreated&&null!=r.$$indexCreated.fieldName?n[r.$$indexCreated.fieldName]=r.$$indexCreated:"string"==typeof r.$$indexRemoved&&delete n[r.$$indexRemoved]}catch(e){o+=1}if(data.length>0&&o/data.length>this.corruptAlertThreshold)throw new Error(`More than ${Math.floor(100*this.corruptAlertThreshold)}% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NeDB to prevent dataloss`);return r.push(...Object.values(t)),{data:r,indexes:n}}loadDatabase(e=(()=>{})){if(this.db.resetIndexes(),this.inMemoryOnly)return e(null);n.waterfall([e=>{h.ensureDirectoryExists(path.dirname(this.filename),(t=>{f.ensureDatafileIntegrity(this.filename,(t=>{f.readFile(this.filename,"utf8",((t,r)=>{if(t)return e(t);let n;try{n=this.treatRawData(r)}catch(t){return e(t)}Object.keys(n.indexes).forEach((e=>{this.db.indexes[e]=new c(n.indexes[e])}));try{this.db.resetIndexes(n.data)}catch(t){return this.db.resetIndexes(),e(t)}this.db.persistence.persistCachedDatabase(e)}))}))}))}],(t=>t?e(t):(this.db.executor.processBuffer(),e(null))))}static ensureDirectoryExists(e,t=(()=>{})){f.mkdir(e,{recursive:!0},(e=>{t(e)}))}static getNWAppFilename(e,r){let n;if("win32"===t.platform||"win64"===t.platform){if(n=t.env.LOCALAPPDATA||t.env.APPDATA,!n)throw new Error("Couldn't find the base application data folder");n=path.join(n,e)}else if("darwin"===t.platform){if(n=t.env.HOME,!n)throw new Error("Couldn't find the base application data directory");n=path.join(n,"Library","Application Support",e)}else{if("linux"!==t.platform)throw new Error(`Can't use the Node Webkit relative path for platform ${t.platform}`);if(n=t.env.HOME,!n)throw new Error("Couldn't find the base application data directory");n=path.join(n,".config",e)}return path.join(n,"nedb-data",r)}}e.exports=h}).call(this,r(182))},438:function(e,t,r){(function(e){function r(e,t){for(var r=0,i=e.length-1;i>=0;i--){var n=e[i];"."===n?e.splice(i,1):".."===n?(e.splice(i,1),r++):r&&(e.splice(i,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function filter(e,t){if(e.filter)return e.filter(t);for(var r=[],i=0;i<e.length;i++)t(e[i],i,e)&&r.push(e[i]);return r}t.resolve=function(){for(var t="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var path=i>=0?arguments[i]:e.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(t=path+"/"+t,n="/"===path.charAt(0))}return(n?"/":"")+(t=r(filter(t.split("/"),(function(p){return!!p})),!n).join("/"))||"."},t.normalize=function(path){var e=t.isAbsolute(path),o="/"===n(path,-1);return(path=r(filter(path.split("/"),(function(p){return!!p})),!e).join("/"))||e||(path="."),path&&o&&(path+="/"),(e?"/":"")+path},t.isAbsolute=function(path){return"/"===path.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(filter(e,(function(p,e){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p})).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var o=n(e.split("/")),c=n(r.split("/")),l=Math.min(o.length,c.length),f=l,i=0;i<l;i++)if(o[i]!==c[i]){f=i;break}var h=[];for(i=f;i<o.length;i++)h.push("..");return(h=h.concat(c.slice(f))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(path){if("string"!=typeof path&&(path+=""),0===path.length)return".";for(var code=path.charCodeAt(0),e=47===code,t=-1,r=!0,i=path.length-1;i>=1;--i)if(47===(code=path.charCodeAt(i))){if(!r){t=i;break}}else r=!1;return-1===t?e?"/":".":e&&1===t?"/":path.slice(0,t)},t.basename=function(path,e){var t=function(path){"string"!=typeof path&&(path+="");var i,e=0,t=-1,r=!0;for(i=path.length-1;i>=0;--i)if(47===path.charCodeAt(i)){if(!r){e=i+1;break}}else-1===t&&(r=!1,t=i+1);return-1===t?"":path.slice(e,t)}(path);return e&&t.substr(-1*e.length)===e&&(t=t.substr(0,t.length-e.length)),t},t.extname=function(path){"string"!=typeof path&&(path+="");for(var e=-1,t=0,r=-1,n=!0,o=0,i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(47!==code)-1===r&&(n=!1,r=i+1),46===code?-1===e?e=i:1!==o&&(o=1):-1!==e&&(o=-1);else if(!n){t=i+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===t+1?"":path.slice(e,r)};var n="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,r(182))},439:function(e,t,r){const n=r(440).createInstance({name:"NeDB",storeName:"nedbdata"}),o=(e,t,r,o)=>{"function"==typeof r&&(o=r),n.setItem(e,t,(()=>o()))};e.exports.exists=(e,t)=>{n.getItem(e,((e,r)=>t(null!==r)))},e.exports.rename=(e,t,r)=>{n.getItem(e,((o,c)=>{null===c?n.removeItem(t,(()=>r())):n.setItem(t,c,(()=>{n.removeItem(e,(()=>r()))}))}))},e.exports.writeFile=o,e.exports.crashSafeWriteFile=o,e.exports.appendFile=(e,t,r,o)=>{"function"==typeof r&&(o=r),n.getItem(e,((r,c)=>{c=c||"",c+=t,n.setItem(e,c,(()=>o()))}))},e.exports.readFile=(e,t,r)=>{"function"==typeof t&&(r=t),n.getItem(e,((e,t)=>r(null,t||"")))},e.exports.unlink=(e,t)=>{n.removeItem(e,(()=>t()))},e.exports.mkdir=(e,t,r)=>r(),e.exports.ensureDatafileIntegrity=(e,t)=>t(null)},440:function(e,t,r){(function(t){e.exports=function e(t,r,n){function s(o,u){if(!r[o]){if(!t[o]){if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[o]={exports:{}};t[o][0].call(l.exports,(function(e){var r=t[o][1][e];return s(r||e)}),l,l.exports,e,t,r,n)}return r[o].exports}for(var i=!1,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,r,n){(function(e){"use strict";var t,n,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var c=0,l=new o(d),element=e.document.createTextNode("");l.observe(element,{characterData:!0}),t=function(){element.data=c=++c%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var f=new e.MessageChannel;f.port1.onmessage=d,t=function(){f.port2.postMessage(0)}}var h=[];function d(){var i,e;n=!0;for(var t=h.length;t;){for(e=h,h=[],i=-1;++i<t;)e[i]();t=h.length}n=!1}function y(e){1!==h.push(e)||n||t()}r.exports=y}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";var n=e(1);function o(){}var c={},l=["REJECTED"],f=["FULFILLED"],h=["PENDING"];function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,e!==o&&w(this,e)}function y(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function v(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return c.reject(e,t)}n===e?c.reject(e,new TypeError("Cannot resolve promise with itself")):c.resolve(e,n)}))}function m(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function w(e,t){var r=!1;function n(t){r||(r=!0,c.reject(e,t))}function o(t){r||(r=!0,c.resolve(e,t))}function l(){t(o,n)}var f=_(l);"error"===f.status&&n(f.value)}function _(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function k(e){return e instanceof this?e:c.resolve(new this(o),e)}function x(e){var t=new this(o);return c.reject(t,e)}function E(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var l=new Array(r),f=0,i=-1,h=new this(o);++i<r;)d(e[i],i);return h;function d(e,i){function o(e){l[i]=e,++f!==r||n||(n=!0,c.resolve(h,l))}t.resolve(e).then(o,(function(e){n||(n=!0,c.reject(h,e))}))}}function A(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=-1,l=new this(o);++i<r;)f(e[i]);return l;function f(e){t.resolve(e).then((function(e){n||(n=!0,c.resolve(l,e))}),(function(e){n||(n=!0,c.reject(l,e))}))}}t.exports=d,d.prototype.catch=function(e){return this.then(null,e)},d.prototype.then=function(e,t){if("function"!=typeof e&&this.state===f||"function"!=typeof t&&this.state===l)return this;var r=new this.constructor(o);return this.state!==h?v(r,this.state===f?e:t,this.outcome):this.queue.push(new y(r,e,t)),r},y.prototype.callFulfilled=function(e){c.resolve(this.promise,e)},y.prototype.otherCallFulfilled=function(e){v(this.promise,this.onFulfilled,e)},y.prototype.callRejected=function(e){c.reject(this.promise,e)},y.prototype.otherCallRejected=function(e){v(this.promise,this.onRejected,e)},c.resolve=function(e,t){var r=_(m,t);if("error"===r.status)return c.reject(e,r.value);var n=r.value;if(n)w(e,n);else{e.state=f,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},c.reject=function(e,t){e.state=l,e.outcome=t;for(var i=-1,r=e.queue.length;++i<r;)e.queue[i].callRejected(t);return e},d.resolve=k,d.reject=x,d.all=E,d.race=A},{1:1}],3:[function(e,r,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var l=c();function f(){try{if(!l||!l.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function h(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(n){if("TypeError"!==n.name)throw n;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var d=Promise;function y(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function v(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function m(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function w(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var _="local-forage-detect-blob-support",k=void 0,x={},E=Object.prototype.toString,A="readonly",O="readwrite";function I(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),i=0;i<t;i++)n[i]=e.charCodeAt(i);return r}function j(e){return new d((function(t){var r=e.transaction(_,O),n=h([""]);r.objectStore(_).put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function $(e){return"boolean"==typeof k?d.resolve(k):j(e).then((function(e){return k=e}))}function S(e){var t=x[e.name],r={};r.promise=new d((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function N(e){var t=x[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function D(e,t){var r=x[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function C(e,t){return new d((function(r,n){if(x[e.name]=x[e.name]||U(),e.db){if(!t)return r(e.db);S(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var c=l.open.apply(l,o);t&&(c.onupgradeneeded=function(t){var r=c.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore(_)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),c.onerror=function(e){e.preventDefault(),n(c.error)},c.onsuccess=function(){r(c.result),N(e)}}))}function T(e){return C(e,!1)}function P(e){return C(e,!0)}function M(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,o=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var c=e.db.version+1;c>e.version&&(e.version=c)}return!0}return!1}function L(e){return new d((function(t,r){var n=new FileReader;n.onerror=r,n.onloadend=function(r){var n=btoa(r.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:e.type})},n.readAsBinaryString(e)}))}function R(e){return h([I(atob(e.data))],{type:e.type})}function F(e){return e&&e.__local_forage_encoded_blob}function B(e){var t=this,r=t._initReady().then((function(){var e=x[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return v(r,e,e),r}function z(e){S(e);for(var t=x[e.name],r=t.forages,i=0;i<r.length;i++){var n=r[i];n._dbInfo.db&&(n._dbInfo.db.close(),n._dbInfo.db=null)}return e.db=null,T(e).then((function(t){return e.db=t,M(e)?P(e):t})).then((function(n){e.db=t.db=n;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=n})).catch((function(t){throw D(e,t),t}))}function K(e,t,r,n){void 0===n&&(n=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(o){if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return d.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),P(e)})).then((function(){return z(e).then((function(){K(e,t,r,n-1)}))})).catch(r);r(o)}}function U(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function V(e){var t=this,r={db:null};if(e)for(var i in e)r[i]=e[i];var n=x[r.name];n||(n=U(),x[r.name]=n),n.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=B);var o=[];function c(){return d.resolve()}for(var l=0;l<n.forages.length;l++){var f=n.forages[l];f!==t&&o.push(f._initReady().catch(c))}var h=n.forages.slice(0);return d.all(o).then((function(){return r.db=n.db,T(r)})).then((function(e){return r.db=e,M(r,t._defaultConfig.version)?P(r):e})).then((function(e){r.db=n.db=e,t._dbInfo=r;for(var o=0;o<h.length;o++){var c=h[o];c!==t&&(c._dbInfo.db=r.db,c._dbInfo.version=r.version)}}))}function W(e,t){var r=this;e=m(e);var n=new d((function(t,n){r.ready().then((function(){K(r._dbInfo,A,(function(o,c){if(o)return n(o);try{var l=c.objectStore(r._dbInfo.storeName).get(e);l.onsuccess=function(){var e=l.result;void 0===e&&(e=null),F(e)&&(e=R(e)),t(e)},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return y(n,t),n}function H(e,t){var r=this,n=new d((function(t,n){r.ready().then((function(){K(r._dbInfo,A,(function(o,c){if(o)return n(o);try{var l=c.objectStore(r._dbInfo.storeName).openCursor(),f=1;l.onsuccess=function(){var cursor=l.result;if(cursor){var r=cursor.value;F(r)&&(r=R(r));var n=e(r,cursor.key,f++);void 0!==n?t(n):cursor.continue()}else t()},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return y(n,t),n}function J(e,t,r){var n=this;e=m(e);var o=new d((function(r,o){var c;n.ready().then((function(){return c=n._dbInfo,"[object Blob]"===E.call(t)?$(c.db).then((function(e){return e?t:L(t)})):t})).then((function(t){K(n._dbInfo,O,(function(c,l){if(c)return o(c);try{var f=l.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var h=f.put(t,e);l.oncomplete=function(){void 0===t&&(t=null),r(t)},l.onabort=l.onerror=function(){var e=h.error?h.error:h.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return y(o,r),o}function Y(e,t){var r=this;e=m(e);var n=new d((function(t,n){r.ready().then((function(){K(r._dbInfo,O,(function(o,c){if(o)return n(o);try{var l=c.objectStore(r._dbInfo.storeName).delete(e);c.oncomplete=function(){t()},c.onerror=function(){n(l.error)},c.onabort=function(){var e=l.error?l.error:l.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return y(n,t),n}function Q(e){var t=this,r=new d((function(e,r){t.ready().then((function(){K(t._dbInfo,O,(function(n,o){if(n)return r(n);try{var c=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=c.error?c.error:c.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return y(r,e),r}function G(e){var t=this,r=new d((function(e,r){t.ready().then((function(){K(t._dbInfo,A,(function(n,o){if(n)return r(n);try{var c=o.objectStore(t._dbInfo.storeName).count();c.onsuccess=function(){e(c.result)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return y(r,e),r}function X(e,t){var r=this,n=new d((function(t,n){e<0?t(null):r.ready().then((function(){K(r._dbInfo,A,(function(o,c){if(o)return n(o);try{var l=c.objectStore(r._dbInfo.storeName),f=!1,h=l.openKeyCursor();h.onsuccess=function(){var cursor=h.result;cursor?0===e||f?t(cursor.key):(f=!0,cursor.advance(e)):t(null)},h.onerror=function(){n(h.error)}}catch(e){n(e)}}))})).catch(n)}));return y(n,t),n}function Z(e){var t=this,r=new d((function(e,r){t.ready().then((function(){K(t._dbInfo,A,(function(n,o){if(n)return r(n);try{var c=o.objectStore(t._dbInfo.storeName).openKeyCursor(),l=[];c.onsuccess=function(){var cursor=c.result;cursor?(l.push(cursor.key),cursor.continue()):e(l)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return y(r,e),r}function ee(e,t){t=w.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;if(e.name){var c=e.name===r.name&&o._dbInfo.db?d.resolve(o._dbInfo.db):T(e).then((function(t){var r=x[e.name],n=r.forages;r.db=t;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=t;return t}));n=e.storeName?c.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;S(e);var n=x[e.name],o=n.forages;t.close();for(var i=0;i<o.length;i++){var c=o[i];c._dbInfo.db=null,c._dbInfo.version=r}return new d((function(t,n){var o=l.open(e.name,r);o.onerror=function(e){o.result.close(),n(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<o.length;t++){var r=o[t];r._dbInfo.db=e,N(r._dbInfo)}})).catch((function(t){throw(D(e,t)||d.resolve()).catch((function(){})),t}))}})):c.then((function(t){S(e);var r=x[e.name],n=r.forages;t.close();for(var i=0;i<n.length;i++)n[i]._dbInfo.db=null;return new d((function(t,r){var n=l.deleteDatabase(e.name);n.onerror=n.onblocked=function(e){var t=n.result;t&&t.close(),r(e)},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}})).then((function(e){r.db=e;for(var i=0;i<n.length;i++)N(n[i]._dbInfo)})).catch((function(t){throw(D(e,t)||d.resolve()).catch((function(){})),t}))}))}else n=d.reject("Invalid arguments");return y(n,t),n}var te={_driver:"asyncStorage",_initStorage:V,_support:f(),iterate:H,getItem:W,setItem:J,removeItem:Y,clear:Q,length:G,key:X,keys:Z,dropInstance:ee};function re(){return"function"==typeof openDatabase}var ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ie="~~local_forage_type~",oe=/^~~local_forage_type~([^~]+)~/,ae="__lfsc__:",se=ae.length,ce="arbf",ue="blob",le="si08",fe="ui08",he="uic8",pe="si16",de="si32",ye="ur16",ve="ui32",ge="fl32",me="fl64",be=se+ce.length,we=Object.prototype.toString;function _e(e){var i,t,r,n,o,c=.75*e.length,l=e.length,p=0;"="===e[e.length-1]&&(c--,"="===e[e.length-2]&&c--);var f=new ArrayBuffer(c),h=new Uint8Array(f);for(i=0;i<l;i+=4)t=ne.indexOf(e[i]),r=ne.indexOf(e[i+1]),n=ne.indexOf(e[i+2]),o=ne.indexOf(e[i+3]),h[p++]=t<<2|r>>4,h[p++]=(15&r)<<4|n>>2,h[p++]=(3&n)<<6|63&o;return f}function ke(e){var i,t=new Uint8Array(e),r="";for(i=0;i<t.length;i+=3)r+=ne[t[i]>>2],r+=ne[(3&t[i])<<4|t[i+1]>>4],r+=ne[(15&t[i+1])<<2|t[i+2]>>6],r+=ne[63&t[i+2]];return t.length%3==2?r=r.substring(0,r.length-1)+"=":t.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function xe(e,t){var r="";if(e&&(r=we.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===we.call(e.buffer))){var n,marker=ae;e instanceof ArrayBuffer?(n=e,marker+=ce):(n=e.buffer,"[object Int8Array]"===r?marker+=le:"[object Uint8Array]"===r?marker+=fe:"[object Uint8ClampedArray]"===r?marker+=he:"[object Int16Array]"===r?marker+=pe:"[object Uint16Array]"===r?marker+=ye:"[object Int32Array]"===r?marker+=de:"[object Uint32Array]"===r?marker+=ve:"[object Float32Array]"===r?marker+=ge:"[object Float64Array]"===r?marker+=me:t(new Error("Failed to get type for BinaryArray"))),t(marker+ke(n))}else if("[object Blob]"===r){var o=new FileReader;o.onload=function(){var r=ie+e.type+"~"+ke(this.result);t(ae+ue+r)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}}function Ee(e){if(e.substring(0,se)!==ae)return JSON.parse(e);var t,r=e.substring(be),n=e.substring(se,be);if(n===ue&&oe.test(r)){var o=r.match(oe);t=o[1],r=r.substring(o[0].length)}var c=_e(r);switch(n){case ce:return c;case ue:return h([c],{type:t});case le:return new Int8Array(c);case fe:return new Uint8Array(c);case he:return new Uint8ClampedArray(c);case pe:return new Int16Array(c);case ye:return new Uint16Array(c);case de:return new Int32Array(c);case ve:return new Uint32Array(c);case ge:return new Float32Array(c);case me:return new Float64Array(c);default:throw new Error("Unkown type: "+n)}}var Ae={serialize:xe,deserialize:Ee,stringToBuffer:_e,bufferToString:ke};function Oe(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function Ie(e){var t=this,r={db:null};if(e)for(var i in e)r[i]="string"!=typeof e[i]?e[i].toString():e[i];var n=new d((function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction((function(o){Oe(o,r,(function(){t._dbInfo=r,e()}),(function(e,t){n(t)}))}),n)}));return r.serializer=Ae,n}function je(e,t,r,n,o,c){e.executeSql(r,n,o,(function(e,l){l.code===l.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,f){f.rows.length?c(e,l):Oe(e,t,(function(){e.executeSql(r,n,o,c)}),c)}),c):c(e,l)}),c)}function $e(e,t){var r=this;e=m(e);var n=new d((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){je(r,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=o.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return y(n,t),n}function Se(e,t){var r=this,n=new d((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){je(r,o,"SELECT * FROM "+o.storeName,[],(function(r,n){for(var c=n.rows,l=c.length,i=0;i<l;i++){var f=c.item(i),h=f.value;if(h&&(h=o.serializer.deserialize(h)),void 0!==(h=e(h,f.key,i+1)))return void t(h)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return y(n,t),n}function Ne(e,t,r,n){var o=this;e=m(e);var c=new d((function(c,l){o.ready().then((function(){void 0===t&&(t=null);var f=t,h=o._dbInfo;h.serializer.serialize(t,(function(t,d){d?l(d):h.db.transaction((function(r){je(r,h,"INSERT OR REPLACE INTO "+h.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){c(f)}),(function(e,t){l(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void c(Ne.apply(o,[e,f,r,n-1]));l(t)}}))}))})).catch(l)}));return y(c,r),c}function De(e,t,r){return Ne.apply(this,[e,t,r,1])}function Ce(e,t){var r=this;e=m(e);var n=new d((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){je(r,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return y(n,t),n}function Te(e){var t=this,r=new d((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){je(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return y(r,e),r}function Pe(e){var t=this,r=new d((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){je(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,r){var n=r.rows.item(0).c;e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return y(r,e),r}function Me(e,t){var r=this,n=new d((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){je(r,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return y(n,t),n}function Le(e){var t=this,r=new d((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){je(t,n,"SELECT key FROM "+n.storeName,[],(function(t,r){for(var n=[],i=0;i<r.rows.length;i++)n.push(r.rows.item(i).key);e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return y(r,e),r}function Re(e){return new d((function(t,r){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,n){for(var o=[],i=0;i<n.rows.length;i++)o.push(n.rows.item(i).name);t({db:e,storeNames:o})}),(function(e,t){r(t)}))}),(function(e){r(e)}))}))}function Fe(e,t){t=w.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;return y(n=e.name?new d((function(t){var n;n=e.name===r.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(Re(n))})).then((function(e){return new d((function(t,r){e.db.transaction((function(n){function o(e){return new d((function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}for(var c=[],i=0,l=e.storeNames.length;i<l;i++)c.push(o(e.storeNames[i]));d.all(c).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):d.reject("Invalid arguments"),t),n}var Be={_driver:"webSQLStorage",_initStorage:Ie,_support:re(),iterate:Se,getItem:$e,setItem:De,removeItem:Ce,clear:Te,length:Pe,key:Me,keys:Le,dropInstance:Fe};function ze(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function qe(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function Ke(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Ue(){return!Ke()||localStorage.length>0}function Ve(e){var t=this,r={};if(e)for(var i in e)r[i]=e[i];return r.keyPrefix=qe(e,t._defaultConfig),Ue()?(t._dbInfo=r,r.serializer=Ae,d.resolve()):d.reject()}function We(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var r=localStorage.key(i);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return y(r,e),r}function He(e,t){var r=this;e=m(e);var n=r.ready().then((function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return y(n,t),n}function Je(e,t){var r=this,n=r.ready().then((function(){for(var t=r._dbInfo,n=t.keyPrefix,o=n.length,c=localStorage.length,l=1,i=0;i<c;i++){var f=localStorage.key(i);if(0===f.indexOf(n)){var h=localStorage.getItem(f);if(h&&(h=t.serializer.deserialize(h)),void 0!==(h=e(h,f.substring(o),l++)))return h}}}));return y(n,t),n}function Ye(e,t){var r=this,n=r.ready().then((function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return y(n,t),n}function Qe(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,n=[],i=0;i<r;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return y(r,e),r}function Ge(e){var t=this.keys().then((function(e){return e.length}));return y(t,e),t}function Xe(e,t){var r=this;e=m(e);var n=r.ready().then((function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return y(n,t),n}function Ze(e,t,r){var n=this;e=m(e);var o=n.ready().then((function(){void 0===t&&(t=null);var r=t;return new d((function(o,c){var l=n._dbInfo;l.serializer.serialize(t,(function(t,n){if(n)c(n);else try{localStorage.setItem(l.keyPrefix+e,t),o(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||c(e),c(e)}}))}))}));return y(o,r),o}function et(e,t){if(t=w.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,o=this;return y(n=e.name?new d((function(t){e.storeName?t(qe(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var i=localStorage.length-1;i>=0;i--){var t=localStorage.key(i);0===t.indexOf(e)&&localStorage.removeItem(t)}})):d.reject("Invalid arguments"),t),n}var tt={_driver:"localStorageWrapper",_initStorage:Ve,_support:ze(),iterate:Je,getItem:He,setItem:Ze,removeItem:Xe,clear:We,length:Ge,key:Ye,keys:Qe,dropInstance:et},nt=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},it=function(e,t){for(var r=e.length,i=0;i<r;){if(nt(e[i],t))return!0;i++}return!1},ot=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},at={},st={},ct={INDEXEDDB:te,WEBSQL:Be,LOCALSTORAGE:tt},ut=[ct.INDEXEDDB._driver,ct.WEBSQL._driver,ct.LOCALSTORAGE._driver],lt=["dropInstance"],ft=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(lt),ht={description:"",driver:ut.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function pt(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function yt(){for(var i=1;i<arguments.length;i++){var e=arguments[i];if(e)for(var t in e)e.hasOwnProperty(t)&&(ot(e[t])?arguments[0][t]=e[t].slice():arguments[0][t]=e[t])}return arguments[0]}var vt=new(function(){function e(t){for(var r in o(this,e),ct)if(ct.hasOwnProperty(r)){var n=ct[r],c=n._driver;this[r]=c,at[c]||this.defineDriver(n)}this._defaultConfig=yt({},ht),this._config=yt({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in e){if("storeName"===i&&(e[i]=e[i].replace(/\W/g,"_")),"version"===i&&"number"!=typeof e[i])return new Error("Database version must be a number.");this._config[i]=e[i]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new d((function(t,r){try{var n=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(o);for(var c=ft.concat("_initStorage"),i=0,l=c.length;i<l;i++){var f=c[i];if((!it(lt,f)||e[f])&&"function"!=typeof e[f])return void r(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=d.reject(t);return y(r,arguments[arguments.length-1]),r}},r=0,n=lt.length;r<n;r++){var o=lt[r];e[o]||(e[o]=t(o))}}();var h=function(r){at[n]&&console.info("Redefining LocalForage driver: "+n),at[n]=e,st[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,r):h(!!e._support):h(!0)}catch(e){r(e)}}));return v(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=at[e]?d.resolve(at[e]):d.reject(new Error("Driver not found."));return v(n,t,r),n},e.prototype.getSerializer=function(e){var t=d.resolve(Ae);return v(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return v(r,e,e),r},e.prototype.setDriver=function(e,t,r){var n=this;ot(e)||(e=[e]);var o=this._getSupportedDrivers(e);function c(){n._config.driver=n.driver()}function l(e){return n._extend(e),c(),n._ready=n._initStorage(n._config),n._ready}function f(e){return function(){var t=0;function r(){for(;t<e.length;){var o=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(o).then(l).catch(r)}c();var f=new Error("No available storage method found.");return n._driverSet=d.reject(f),n._driverSet}return r()}}var h=null!==this._driverSet?this._driverSet.catch((function(){return d.resolve()})):d.resolve();return this._driverSet=h.then((function(){var e=o[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,c(),n._wrapLibraryMethodsWithReady(),n._initDriver=f(o)}))})).catch((function(){c();var e=new Error("No available storage method found.");return n._driverSet=d.reject(e),n._driverSet})),v(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!st[e]},e.prototype._extend=function(e){yt(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],i=0,r=e.length;i<r;i++){var n=e[i];this.supports(n)&&t.push(n)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var i=0,e=ft.length;i<e;i++)pt(this,ft[i])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=vt},{3:3}]},{},[4])(4)}).call(this,r(72))}}]);